<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reown AppKit + Ethers Demo (CDN Only)</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    button { padding: 0.5rem 1rem; font-size: 1rem; }
    #status { margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Connect Wallet / Email / Social (No Bundler)</h1>
  <button id="connect">Connect</button>
  <div id="status">Not connected</div>

  <!-- 1) Ethers.js for provider/signer -->
  <script type="module">
    import { ethers } from 'https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js';
    import {
      EthersAdapter,
      ReownAppKit,
      BitcoinChain
    } from 'https://cdn.jsdelivr.net/npm/@reown/appkit-cdn@latest/dist/index.esm.js';
    import { mainnet, polygon } from 'https://cdn.jsdelivr.net/npm/viem@1.1.0/dist/chains.esm.js';

    // 2) Define zkSync Era
    const zkEvmEra = {
      id: 324,
      name: 'zkSync Era',
      network: 'zksync-era',
      nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },
      rpcUrls: { default: { http: ['https://mainnet.era.zksync.io'] } },
      blockExplorers: { default: { name: 'zkSync Explorer', url: 'https://explorer.zksync.io' } },
      testnet: false
    };

    // 3) Initialize Ethers provider (window.ethereum must be injected by wallet)
    const windowProvider = new ethers.providers.Web3Provider(window.ethereum, 'any');
    const sdkChains = [ mainnet, polygon, zkEvmEra, BitcoinChain ];

    // 4) Wrap for AppKit
    const ethersAdapter = new EthersAdapter({
      provider: windowProvider,
      getSigner: () => windowProvider.getSigner()
    });

    // 5) Initialize Reown AppKit
    const appkit = new ReownAppKit({
      projectId: 'c2ad0915b40b1da8a324c6699a8d0793',
      adapters: [ethersAdapter],
      networks: sdkChains
    });

    // 6) Connect logic
    document.getElementById('connect').addEventListener('click', async () => {
      // Request accounts
      await window.ethereum.request({ method: 'eth_requestAccounts' });
      const session = await appkit.connect({ signInMethods: ['wallet', 'email', 'social'] });
      if (session.connected) {
        document.getElementById('status').innerText =
          `Connected: ${session.address} (${session.name ?? 'no custom name'})`;
      } else {
        document.getElementById('status').innerText = 'Not connected';
      }
    });
  </script>
</body>
</html>
